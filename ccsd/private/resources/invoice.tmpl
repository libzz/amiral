<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
<!DOCTYPE document SYSTEM "rml_1_0.dtd">
<document filename="${invoice_file}.pdf">
<template leftMargin="2.5cm" rightMargin="2.5cm" 
    topMargin="1.0cm" bottomMargin="1.0cm" title="CCSD Invoice" 
    author="Generated by CCSD" allowSplitting="20">
	<pageTemplate id="invoice">
        <!-- Page elements -->
		<pageGraphics>
            <!-- Top image, title and GST number -->
			<image x="6cm" y="26cm" file="$template_dir/logo.gif"/>
			<setFont name="Helvetica-Bold" size="14"/>
			<fill color="(0,0,0)"/>
			<drawCentredString x="10.5cm" y="25.4cm">Tax Invoice</drawCentredString>
			<setFont name="Helvetica" size="12"/>
			<drawCentredString x="10.5cm" y="24.8cm">GST No. 93-771-710</drawCentredString>
            <!-- Bottom footer, contact details -->
			<setFont name="Helvetica" size="8"/>
            <drawCentredString x="10.5cm" y="1cm">Rural Link Limited  Waikato Innovation Park,    Ruakura Rd. PO Box 9466, Hamilton, NZ   ph 0800 12 13 14 www.rurallink.co.nz</drawCentredString>
		</pageGraphics>
        <!-- Page content sits inside this frame -->
		<frame id="first" x1="2.5cm" y1="0cm" width="16cm" height="24cm"/>
	</pageTemplate>
</template>
<stylesheet>
	<blockTableStyle id="invoicedetails">
        <blockFont name="Helvetica" size="10" />
        <blockFont name="Helvetica-Bold" size="10" start="0,0" stop="0,-1" />
	</blockTableStyle>
	
    <paraStyle name="name" fontName="Helvetica-Bold" size="10" spaceBefore="0.5cm" />
    <paraStyle name="address" fontName="Helvetica" size="10" spaceAfter="2cm" />

    <paraStyle name="currency" fontName="Helvetica" size="10" />
        
	<blockTableStyle id="records">
        <blockFont name="Helvetica" size="10" />
		<blockTextColor colorName="black" />
        <!-- First row is bold and shaded -->
        <blockFont name="Helvetica-Bold" size="10" start="0,0" stop="-1,0" />
        <blockBackground colorName="darkgray" start="0,0" stop="-1,0" />
        <!-- Last three columns are right aligned -->
        <blockAlignment value="RIGHT" start="3,1" stop="-1,-1" />
	</blockTableStyle>

	<blockTableStyle id="recordtotals">
        <blockFont name="Helvetica" size="10" />
		<blockTextColor colorName="black" />
        <!-- First column is bold -->
        <blockFont name="Helvetica-Bold" size="10" start="0,0" stop="0,-1" />
        <!-- Borders -->
        <lineStyle kind="LINEABOVE" colorName="black" start="-1,0" stop="-1,0" />
        <lineStyle kind="LINEABOVE" colorName="black" start="-1,-1" stop="-1,-1" />
        <lineStyle kind="LINEBELOW" colorName="black" start="-1,-1" stop="-1,-1" thickness="3" />
        <!-- Last column is right aligned -->
        <blockAlignment value="RIGHT" start="1,0" stop="-1,-1" />
	</blockTableStyle>
    <paraStyle name="payment" fontName="Helvetica" fontSize="8" spaceBefore="1.5cm" leftIndent="0.0cm" rightIndent="1.5cm" />
    <paraStyle name="payment2" fontName="Helvetica" fontSize="8" spaceBefore="0.1cm" leftIndent="0.0cm" rightIndent="1.5cm" />
</stylesheet>
<story>
    <!-- Important that widths add up to frame width or alignment breaks -->
    <blockTable colWidths="4cm,12cm" style="invoicedetails">
    <tr>
        <td>Customer Username</td><td>$invoice.contact.username</td>
    </tr>
    <tr>
        <td>Invoice Number</td><td>$invoice_id</td>
    </tr>
    <tr>
        <td>Invoice Date</td><td>$invoice.invoice_date_str</td>
    </tr>
    </blockTable>

    <!-- Billing Contact and Address, important to use pre for line breaks -->
	<para style="name">$invoice.contact.billing_name</para>
	<pre style="address">$invoice.contact.billing_address</pre>

    <!-- Now deal with the actual invoice items -->
	<blockTable colWidths="3cm,7cm,2cm,2cm,2cm" style="records">
	<tr>
		<td>Date</td><td>Description</td><td>Each</td>
        <td>Quantity</td><td>Subtotal</td>
	</tr>
#for $record in $invoice.records
	<tr>
		<td>$record.record_date_str</td>
		<td><para>$record.description</para></td>
        <td>$dolarify($record.amount)</td>
        <td>$record.quantity</td>
		<td>$dolarify($record.calculated_amount)</td>
	</tr>
#end for
	</blockTable>
    <spacer length="2cm" />
    <!-- Invoice Totals at the bottom -->
	<blockTable colWidths="14cm,2cm" style="recordtotals">
	<tr>
        <td>Total ex GST:</td>
        <td>$dolarify($invoice.invoice_subtotal)</td>
	</tr>
    <tr>
        <td>GST (12.5%) </td>
        <td>$dolarify($invoice.gst)</td>
	</tr><tr>
        <td>Total inc GST: </td>
        <td>$dolarify($invoice.total)</td>
	</tr>
	</blockTable>
	<xpre style="payment">
<b>Payment Methods:</b>
- Direct Debit (preferred). If we have your direct debit details on file we will debit \$$invoice.total from your bank account on
 ${invoice.payment_date_str}, unless we  hear from you by $invoice.payment_notify_date_str. You can find the direct debit form on our web site,
under Terms and Conditions.
</xpre>
 
<xpre style="payment2">
- Online Banking/Direct Credit: Make your payment to Rural Link Limited, ASB Bank 12-3249-0014372-00. Use
your username as the Reference.
</xpre>
 
<xpre style="payment2">
- Cheque - send your check to Accounts, Rural Link Limited, PO Box 9466, Hamilton.
</xpre>
</story>
</document>
